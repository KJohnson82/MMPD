@page "/metalmart"
@using MMPD.Data.Models
@using MMPD.Data.Context
@using MMPD.Data
@inject IDirectoryService DirectoryService
@inject NavigationManager NavigationManager
@inject IJSRuntime JSRuntime
@using MMPD.Shared.Components
@using MMPD.Shared.Layout
@using Telerik.Blazor
@using Telerik.Blazor.Components
@using Telerik.SvgIcons
@inject MMPD.Shared.Services.LayoutState LayoutState

<PageTitle>Metal Mart</PageTitle>

@if (Locations == null || Locations.Count == 0)
{
    <p>Loading Metal Marts...</p>
}
else
{
    <div class="button-page-container">

        <div class="scrollable-wrapper">
            

            <TelerikListView Data="@Locations" Class="button-list-container">
                <Template Context="loc">
                    <NavLink class="text-decoration-none text-uppercase"
                             href="@($"/metalmart/{loc.Id}")">
                        <div class="menu-item py-3 px-4 my-2 rounded-3 k-text-white tracking-wider k-font-size-lg" style="font-size: medium; font-weight: bold; letter-spacing: 2px;">
                            <div class="k-align-items-center">@loc.LocName   </div>
                            <div class="k-color-dark k-font-bold k-font-size-sm">@loc.City, @loc.State</div>

                        </div>
                    </NavLink>
                </Template>
            </TelerikListView>
        </div>

    </div>
}

@code {
    private HeaderCardModels.HeadInfoCardModel? StoreInfo;
    private List<Location> Locations = new();
    private Location? Store;

    [Parameter]
    public int storeID { get; set; }

    private Dictionary<string, string> AreaManagers => new()
    {
        { "Northeast", "David Boyte" },
        { "Central", "John Baker" },
        { "South Central", "Beau Brown" },
        { "New Mexico", "Cliff Loveless" },
        { "Southeast", "Michael Northen" },
        { "Southwest", "Shaun Steinemann" }
    };

    private List<FooterNav.FooterItem> FooterNavItems = new()
{
    new FooterNav.FooterItem(CustomIcons.Home, "Home", "/"),
    new FooterNav.FooterItem(CustomIcons.Corporate, "Corporate", "/corporate"),
    // new FooterNav.FooterItem(CustomIcons.MetalMart, "Metal Mart", "/metalmart"),
    new FooterNav.FooterItem(CustomIcons.ServiceCenter, "Service Center", "/servicecenter"),
    new FooterNav.FooterItem(CustomIcons.Plant, "Plant", "/plant")

};


    protected override async Task OnInitializedAsync()
    {

        Locations = await DirectoryService.GetLocationsByTypeAsync("metal mart");

        Locations = Locations.OrderBy(l => l.LocNum).ToList();

        StoreInfo = HeaderCardModels.Store(
            title: "Metal Mart",
            subtitle1: "Northeast",
            tmanager1: "David Boyte",
            subtitle2: "Central",
            tmanager2: "John Baker",
            subtitle3: "South Central",
            tmanager3: "Beau Brown",
            subtitle4: "New Mexico",
            tmanager4: "Cliff Loveless",
            subtitle5: "Southeast",
            tmanager5: "Michael Northen",
            subtitle6: "Southwest",
            tmanager6: "Shaun Steinemann"
         );

    }

    protected override void OnAfterRender(bool firstRender)
    {
        if (firstRender && StoreInfo != null)
        {
            LayoutState.SetHeader(StoreInfo);
            LayoutState.SetFooter(FooterNavItems);
        }
    }
}
