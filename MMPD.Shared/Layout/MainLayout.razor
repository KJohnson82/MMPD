
@inherits LayoutComponentBase
@using Telerik.Blazor
@using Telerik.Blazor.Components
@implements IDisposable

@inject MMPD.Shared.Services.LayoutState LayoutState


<TelerikRootComponent>
    <div class="main-layout-container">
        
        <header class="main-layout-header k-rounded-none k-bg-primary">
            <HeaderCard Info="LayoutState.HeaderInfo" />
        </header>

        <main class="main-layout-content no-scrollbar">
            @Body
        </main>

        <footer class="main-layout-footer">
            <FooterNav Items="LayoutState.FooterItems" />
        </footer>

    </div>
</TelerikRootComponent>

@code {
    protected override void OnInitialized()
    {
        LayoutState.OnChange += OnStateChanged;
    }

    private async void OnStateChanged()
    {
        // Safely update the UI when the state changes
        await InvokeAsync(StateHasChanged);
    }

    public void Dispose()
    {
        // Unsubscribe to prevent memory leaks
        LayoutState.OnChange -= OnStateChanged;
    }
}

<style>
    .main-layout-container {
        display: flex;
        flex-direction: column;
        height: 100vh;
    }

    .main-layout-header,
    .main-layout-footer {
        flex-shrink: 0; /* Prevents header/footer from shrinking */
    }

    .main-layout-content {
        flex-grow: 1; /* Makes the main content fill all available space */
        overflow-y: auto; /* Adds a scrollbar ONLY to this area if needed */
    }
</style>