@page "/servicecenter"
@using MMPD.Data.Models
@using MMPD.Data.Data
@using MMPD.Data.Context
@using MMPD.Shared.Components
@inject IDirectoryService DirectoryService
@inject NavigationManager NavigationManager
@using Telerik.Blazor
@using Telerik.Blazor.Components
@using Telerik.SvgIcons
@using MMPD.Shared.Layout
@inject IJSRuntime JSRuntime

<PageTitle>Service Center</PageTitle>

@if (Locations == null || Locations.Count == 0)
{
    <p>Loading service centers...</p>
}
else
{
    <div class="flex flex-col h-screen">
        <section>
            <HeadTitleCard Entries="AreaManagers" />
        </section>

        <section class="flex-grow bg-neutral pb-0 pt-0 overflow-y-scroll no-scrollbar">
            <div class="shadow-sm drop-shadow-sm bg-accent">
                <SearchBar />
            </div>

            <TelerikListView Data="@Locations" Class="ps-2 py-1 pe-2 border-4 border-transparent overflow-y-auto no-scrollbar">
                <Template Context="loc">
                    <NavLink class="text-white underline hover:text-blue-100 text-decoration-none text-uppercase"
                             href="@($"/servicecenter/{loc.Id}")">
                        <div class="bg-primary text-white-content rounded shadow-md my-2 py-3 px-4 hover:shadow-lg hover:scale-105 transition">
                            <div class="text-xxl-start font-semibold uppercase tracking-wide">
                                @loc.LocName - @loc.City, @loc.State
                            </div>
                        </div>
                    </NavLink>
                </Template>
            </TelerikListView>
        </section>

        <div class="divide divide-none divide-y-2 py-0"></div>
        <section class="box-border pb-3 mt-0">
            <FooterNav Items="footerItems" />
        </section>
    </div>
}

@code {
    private List<Location> Locations = new();

    private Dictionary<string, string> AreaManagers => new()
    {
        { "Northeast", "David Boyte" },
        { "Central", "John Baker" },
        { "South Central", "Beau Brown" },
        { "New Mexico", "Cliff Loveless" },
        { "Southeast", "Michael Northen" },
        { "Southwest", "Shaun Steinemann" }
    };

    private List<FooterNav.FooterItem> footerItems = new()
    {
        new(CustomIcons.Home, "Home", "/"),
        new(CustomIcons.Corporate, "Corporate", "/corporate"),
        new(CustomIcons.MetalMart, "Metal Mart", "/metalmart"),
        new(CustomIcons.ServiceCenter, "Service Center", "/servicecenter")
    };

    protected override async Task OnInitializedAsync()
    {
        Locations = await DirectoryService.GetLocationsByTypeAsync("service center");
    }
}
